<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">

    <title>Automagic API</title>
    
    <meta name="description" content="">
    <meta name="author" content="Travis Hoppe">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" 
	  content="black-translucent" />

    <meta name="viewport" content="width=device-width, 
				   initial-scale=1.0, 
				   maximum-scale=1.0, 
				   user-scalable=no">

    <link rel="stylesheet" href="reveal.js/css/reveal.css">

    <!-- Default themes -->
    <link rel="stylesheet" href="reveal.js/css/theme/simple.css" id="theme">
    <link rel="stylesheet" href="reveal.js/css/theme/white.css" id="theme">

    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">

    <!-- For LaTeX formating highlighting -->
    <link rel="stylesheet" href="md2reveal/css/md2reveal_style.css">

    <!--[if lt IE 9]>
	<script src="reveal.js/lib/js/html5shiv.js"></script>
	<![endif]-->
  </head>

  <body>

    <div class="reveal"><div class="slides">
	<section class="vertical-stack">
<section   class="vertical-slide">
<p>
<h1>automagic-API</h1><em>(five minute hack-and-tell version)</em></p>
<br>
<p>
<strong><a href="http://thoppe.github.io/">Travis Hoppe</a></strong></p>
<hr>
<p>
<a href="https://github.com/thoppe/automagic-api">https://github.com/thoppe/automagic-api</a><br><link rel="stylesheet" href="css/font-awesome-4.3.0/css/font-awesome.min.css"></p>
</section>
</section><section class="vertical-stack">
<section   class="vertical-slide">
<p>
<h1>I <i class="fa fa-heart"></i> data</h1><h1>I <i class="fa fa-heart"></i> a good API</h1><em>but the internet does not always love me back</em></p>
</section><section   class="vertical-slide">
<p>
<h2>Web scraping sucks to do by hand...</h2></p>
<figure>
    <a href="images/scrape.png">
    <img class="" src="images/scrape.png" >
    </a>
    
    </figure>
<p>
wouldn't it be awesome if we could automate some of it?<br><div class="reference_footnote">Examples from the <a href="http://www.j-archive.com/">J! Archive</a></div></p>
</section>
</section><section class="vertical-stack">
<section   class="vertical-slide">
<p>
<h1>Automagic-API!</h1>builds an interactive API builder <em>(so meta)</em></p>
<br>
<p>
Step #1: Download some sample pages</p>
<pre><code class=python>python construct_API_tree.py --name Jeopardy samples/jeo/*</code></pre>
<p>
looks at the DOM "graph" from classes</p>
<pre><code class=python>{'category': 39,
 'category_comments': 39,
 'category_name': 39,
 'clue': 183,
 'clue_header': 180,
  ...</code></pre>
<p>
removes redundant elements</p>
<pre><code class=python>search possibly repeated text, dropping
noborder possibly repeated text, dropping
...</code></pre>
</section><section   class="vertical-slide">
<p>
Builds an ugly tree</p>
<figure>
    <a href="images/ugly_tree.png">
    <img class="" src="images/ugly_tree.png" >
    </a>
    
    </figure>
<br>
<p>
and the uses d3 to create a <a href="d3_viewer/viewer.html">beautiful one</a>!</p>
</section><section   class="vertical-slide">
<p>
Step #2: Select the DOM elements you want to keep<br>Step #3: Build the API</p>
<br>
<pre><code class=python>python build_API_from_tree.py samples/output_graph.svg samples/jeopardy.api</code></pre>
<br>
<pre><code class=python>{
  &quot;round&quot;: {
    &quot;category&quot;: {
      &quot;category_name&quot;: {}
    }, 
    &quot;clue&quot;: {
      &quot;clue_text&quot;: {}
    }
  }
}</code></pre>
</section><section   class="vertical-slide">
<p>
Step #3: Automagic! Query the new API:</p>
<pre><code class=python>api = load_API(args.API)
url = &quot;http://j-archive.com/showgame.php&quot;
payload = {&quot;game_id&quot;:4860}

req  = requests.get(url,params=payload)
soup = bs4.BeautifulSoup(req.content,'html5')
data = dive(api, soup)</code></pre>
<p>
And get wonderful data!</p>
<pre><code class=python>{u'final_round': [{u'category': [{u'category_name': [u'COMEDY INSPIRATIONS']}],
               u'clue': [{u'clue_text': [u'Rodney Dangerfield credited this 1972 Best Picture Oscar winner for inspiring his most famous line']}]}],
    u'round': [{u'category': [{u'category_name': [u'THE FAULT IN OUR STATES']},
        {u'category_name': [u'FOOD &amp; DRINK']},
        {'category_name': [u'BETTER KNOWN BY ONE NAME']},
        {'category_name': [u'TV VIOLENCE']},
        {'category_name': [u'CAUTION, DECONSTRUCTION UNDERWAY']},
...</code></pre>
</section>
</section><section class="vertical-stack">
<section   class="vertical-slide">
<p>
So much more to do!</p>
<br>
<ul><li>Advanced API queries (flattening)</li>
<li>Export API's to standalone BeautifulSoups?</li>
<li>More fine-grained machine learning of bad DOM elements</li>
<li>Apply to other DOM elements (id's?)</li></ul>
</section><section   class="vertical-slide">
<p>
<h1>Thanks you!</h1></p>
<br>
<p>
<div style="footnote"><br>Looking for an overpowered scientist turned analyst/developer? Let's talk!<br><strong>travis.hoppe @ gmail.com</strong><br></div></p>
</section>
</section>
    </div></div>

    <script src="reveal.js/lib/js/head.min.js"></script>
    <script src="reveal.js/js/reveal.js"></script>

    <script>
      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
      overview: true, height: 900, keyboard: true, touch: true, hideAddressBar: true, rollingLinks: false, mouseWheel: true, controls: false, width: 1200, viewDistance: 3, rtl: false, progress: true, fragments: true, autoSlide: 0, autoSlideStoppable: true, backgroundtransition: "default", transitionSpeed: "default", slideNumber: true, center: true, embedded: true, transition: "default", maxScale: 1.2, minScale: 0.2, previewLinks: false, margin: 0.05, loop: false, history: true, 
      
      theme: Reveal.getQueryHash().theme, 
      // available themes are in reveal.js/css/theme

      // Optional libraries used to extend on reveal.js
      dependencies: [ { src: 'reveal.js/lib/js/classList.js', condition: function() { 
    return !document.body.classList; } },

{ src: 'reveal.js/plugin/markdown/showdown.js', condition: function() { 
    return !!document.querySelector( '[data-markdown]' ); } },

{ src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { 
    return !!document.querySelector( '[data-markdown]' ); } },

{ src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: 
  function() { hljs.initHighlightingOnLoad(); } },

{ src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: 
  function() { return !!document.body.classList; } },
 ]

      });
    </script>

  </body>
</html>
